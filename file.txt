this is pseudo code
some modification
some more modification
edited in branch2