this is pseudo code
some modification
some more modification